PART 0 ‚Äî RESET & VALIDATION PASS (RUN THIS FIRST)

GOAL
- You are NOT starting from scratch.
- Assume this repo already contains a previous merged result:
  `C:\Users\Kubik\Downloads\filter\All filters\Merged_Ultimate.filter`
- Your job now is to:
  1) Re-validate that `Merged_Ultimate.filter` actually contains EVERYTHING
     from all source PD2 filters and docs.
  2) Fix any gaps, duplicates, or readability issues.
  3) Output an updated, fully-validated `Merged_Ultimate.filter` (same name).

RULES

1) ALWAYS RELOAD CURRENT MERGED FILE
   - Before doing any other work, read the current merged file:
     `Merged_Ultimate.filter` (and/or `MergedUltimatePD2Filter.filter`)
   - Use the CHUNKED READING RULE (500-line chunks) to read it COMPLETELY.

2) RE-RUN PREPASS ON ALL SOURCE FILES
   - Re-run the PREPASS inventory over:
     `C:\Users\Kubik\Downloads\filter\All filters\`
   - Discover ALL `.filter`, `.html`, and relevant `.txt` PD2 files.
   - For EACH discovered file, apply the GLOBAL CHUNKED-READING RULE.
   - Do NOT assume any previous run was complete; re-scan everything.

3) COMPARE SOURCES vs MERGED_ULTIMATE
   For each source file:
   - Determine which aliases, ItemDisplay rules, and logic:
     a) Already exist in `Merged_Ultimate.filter`
     b) Are missing and still need to be added
   - If missing, integrate them now into `Merged_Ultimate.filter` in the
     correct section, following the merge plan and section order.

4) CLEAN UP & DEDUPE
   - After all new content is merged:
     ‚Ä¢ Scan `Merged_Ultimate.filter` for duplicate or overlapping rules.
     ‚Ä¢ Merge or remove duplicates while preserving behavior.
     ‚Ä¢ Make sure no item is accidentally hidden or processed twice.
   - Simplify long item texts and names to short, readable labels while
     keeping important tags and hints (gold, gems, {Sell}, {Craft}, etc.).

5) FINAL OUTPUT
   - Overwrite / regenerate a single, final:
     `Merged_Ultimate.filter`
   - Use the later sections of this file (PREPASS, BASE SETUP, VISUAL LAYER,
     ECONOMY LAYER, FINAL PASS, CHECKLIST) as the detailed spec for how to
     merge, clean up, and format everything.
   - When all steps are done, print `[[DONE]]` at the end of the last block.

PREPASS ‚Äî INVENTORY & COMPLETENESS AUDIT

SOURCE FOLDER
- Treat this as the working directory for all filters:  
  `C:\Users\Kubik\Downloads\filter\All filters\`

BASE FILTER
- Use this file as the already-merged base we‚Äôre expanding:  
  "C:\Users\Kubik\Downloads\filter\All filters\filter for editing my current filter modified\MergedUltimatePD2Filter.filter"

TASKS
1) INVENTORY: List every `.filter` file found under the folder (including subfolders of known repos) and group by project (Hiim, Kassahi, eqN, Feather, TalRasha, PD2, DHFilter, Kryszard, etc.). For each, list notable sections (maps, runes, runewords, LLD, shopping/gambling, socket rules, jewels/charms, staffmods, crafting, quest/uber mats).
2) GAP MAP: For each group, mark which features are missing from the base hiim-based filter (MergedUltimatePD2Filter.filter).
3) PLAN: Output a concise merge plan (checklist) with section order. This plan will drive Part 1‚Äì4.
// ADDED:
4) CRAFTING RECOMMENDATIONS: When scanning each filter, also note any rules, comments, or tags that indicate items are ‚Äúrecommended to craft‚Äù or ‚Äúnot recommended to craft‚Äù so they can be merged into the base later.
// ADDED:
5) GLOBAL PD2 COVERAGE: Treat every Project Diablo 2‚Äìrelated file in this folder (all `.filter`, `.html`, and relevant `.txt`) as potentially useful. Do not assume any PD2 file is irrelevant until it has been fully read and checked.

OUTPUT
- Emit only the audit + plan (‚â§200 lines). Then stop and print `[[READY_FOR_PART_1]]`.


CHUNKED READING RULE (IMPORTANT)

The tools (Read, Grep, etc.) have size limits. Whenever you work with any
large `.filter`, `.html`, or `.txt` file, you MUST read it in multiple chunks instead
of trying to read the whole file at once.

// ADDED: This applies to EVERY PD2-related file discovered in PREPASS.

1) For each big file, first find the total number of lines:
   Bash
   wc -l "<path-to-file>"

2) Then scan the file in fixed-size chunks, for example 500 lines at a time.
   Use Bash + sed or head/tail, e.g.:

   # lines 1‚Äì500
   Bash
   sed -n '1,500p' "<path-to-file>"

   # lines 501‚Äì1000
   Bash
   sed -n '501,1000p' "<path-to-file>"

   # lines 1001‚Äì1500
   Bash
   sed -n '1001,1500p' "<path-to-file>"

   ‚Ä¶and so on, increasing the ranges until you reach the total line count.
   You may also use:
   Bash
   tail -n +<start> "<path-to-file>" | head -n 500

3) For EACH chunk, you must scan for:
   - Aliases
   - ItemDisplay rules
   - Crafting / economy tags
   - Build-specific logic and staffmods
   - Any unique logic or comments this filter adds

4) Only after you have processed all chunks of a file should you treat that
   file as ‚Äúfully read‚Äù and use it in the merge. Do NOT rely on a single
   partial Read when the tool reports a size limit.

If the Read tool itself is used with offset/limit, apply the same idea:
loop over the file with increasing offsets and fixed limits (for example
limit = 250000 characters) until you have covered the full file.

// ADDED ‚Äì CONSUME & MARK SOURCE FILTERS
5) For every source `.filter` file:
   - Keep track of which rules/aliases/comments you actually copy or adapt into `Merged_Ultimate.filter`.
   - After integrating those rules into `Merged_Ultimate.filter`, go back to the source `.filter` and EITHER:
     ‚Ä¢ Comment them out with a clear tag like `// USED_IN_MERGE_V2.0`, OR  
     ‚Ä¢ Remove them entirely and leave a short comment block at the top listing what was consumed.
   - The goal is: after the merge, any remaining ACTIVE rules in the source filter represent content that was not used. This lets you verify that the file was fully scanned and which parts were actually included.
   - Do NOT modify the base `Merged_Ultimate.filter` this way; only apply this ‚Äúconsume & mark‚Äù behavior to the *source* filters you are pulling from (Hiim builder files, Kassahi, eqN, etc.).


üß± BASE SETUP
- Use this file as the **base filter**:  
  `C:\Users\Kubik\Downloads\filter\All filters\filter for editing my current filter modified\MergedUltimatePD2Filter.filter`
- All additional filters to pull data and rules are in folders to which dev created the filter and can also be found usually at the top of the .filter file and are stored in:  
  `C:\Users\Kubik\Downloads\filter\All filters\`

üéØ OBJECTIVE
Merge all filters in that folder into the base hiim-based filter by:
- Comparing each file and identifying anything unique or missing from the base.
- Adding all those unique sections, item rules, alias definitions, crafting recommendations, and comments into the base.
- Do NOT delete or modify existing base logic except:
  ‚Ä¢ To remove/harden duplicate rules, or  
  ‚Ä¢ To shorten text for readability while preserving meaning.

// ADDED:
Also incorporate external crafting information from the Project Diablo 2 crafting guide:
- Use the file `Crafting - Project Diablo 2.html` (PD2 wiki page) in this repo as a reference for crafting recipes, item bases, and recommendations.
- Treat that page as an authoritative source for which bases and crafts should be labeled as `{Recommended Craft}` or `{Not Recommended Craft}` in the filter, when such guidance is present or can be inferred consistently with the rest of the filter‚Äôs tier logic.

üß© OUTPUT REQUIREMENTS
- Maintain clear section headers.
- Preserve PD2 formatting and encoding (no invalid characters).
- Output the merged result as `Merged_Ultimate.filter`, using Markdown code blocks of ‚â§100k tokens.
- At the end of each chunk, add a marker like `[[CONTINUE:n]]` for the next part.
- Begin by printing a short Table of Contents of major sections to be included.
- After the new `Merged_Ultimate.filter` is produced, perform a second validation pass using `Merged_Ultimate.filter` itself as the reference:
  ‚Ä¢ Confirm that all features described in the plan and gap map are actually present.  
  ‚Ä¢ Confirm that everything previously present in `MergedUltimatePD2Filter.filter` still exists (unless intentionally simplified or deduplicated).

Then start emitting `Merged_Ultimate.filter (Part 1)` code immediately.


VISUAL & CLASS ENHANCEMENT LAYER

üü° UNHIDE GOLD
- Make all gold visible in every context (maps, towns, dungeons, etc.).
- Use a bright, readable ‚Äúgolden yellow‚Äù color for text and a clear pickup sound.

// ADDED ‚Äì GEM VISIBILITY
- Make all gems (chipped, normal, flawless, perfect) visible at all filter levels.
- You may still tier their emphasis (e.g. Perfect > Flawless > others), but do not fully hide them.
- Gems should be easy to spot and readable, especially for crafting and reroll recipes.

üé® CLASS THEMES
- Assign unique color schemes to each class for class-specific gear, crafts, and drops:
  ‚Ä¢ Paladin ‚Äì Holy Light (gold-white)  
  ‚Ä¢ Barbarian ‚Äì Deep Red + Steel Gray  
  ‚Ä¢ Sorceress ‚Äì Arcane Blue  
  ‚Ä¢ Amazon ‚Äì Emerald Green  
  ‚Ä¢ Assassin ‚Äì Shadow Violet  
  ‚Ä¢ Necromancer ‚Äì Bone White / Ivory  
  ‚Ä¢ Druid ‚Äì Forest Green  
- Apply these consistently to class item bases, skill/staffmod items, and crafting bases.

‚öíÔ∏è CRAFTING BASES
- Add top-tier crafting bases per class (armor, weapons, shields, jewels, charms).
- Show sockets, item level (if possible), runeword eligibility, and quality tier.
- If not already in the base, import or define missing base categories.

// ADDED ‚Äì TEXT SHORTENING / READABILITY
- When displaying items, prioritize short, clear labels over long sentences.
- Compress ground text to essentials:
  ‚Ä¢ Item/base name  
  ‚Ä¢ Key tags (e.g. `{Craft T1}`, `{Trade}`, `{RW}`, `{Larzuk 4os}`)  
  ‚Ä¢ Very short hints instead of paragraphs (e.g. `Cube PGem` instead of full sentences).
- Remove redundant words and repeated color codes where possible to make the screen easier to read.

üì¶ OUTPUT
Continue the code output of `Merged_Ultimate.filter` where you left off.
End each code block with `[[CONTINUE:n]]`.


ECONOMY & CRAFTING INTELLIGENCE LAYER

üí∞ PROFIT SYSTEM
- Tag drops by function:
  `{Sell}` = high vendor value  
  `{Trade}` = strong market value  
  `{Keep}` = good for self-use  
  `{Craft}` = crafting base or recipe target  
  `{Salvage}` = cube material  
- Add visible hints next to item names or in comments.

// ADDED ‚Äì CRAFTING RECOMMENDATIONS FROM FILTERS + WIKI
- Search all `.filter` files in `C:\Users\Kubik\Downloads\filter\All filters\` for any logic, tags, or comments that indicate:
  ‚Ä¢ ‚Äúrecommended to craft‚Äù  
  ‚Ä¢ ‚Äúnot recommended to craft‚Äù  
  ‚Ä¢ or similar wording for crafting priorities.
- Merge these recommendations into `Merged_Ultimate.filter` by:
  ‚Ä¢ Adding `{Recommended Craft}` or `{Not Recommended Craft}` style tags near affected items/bases.  
  ‚Ä¢ Keeping the original filter‚Äôs intent (if a filter says something is bad to craft, preserve that meaning).  
- Combine that with the recommendations from `Crafting - Project Diablo 2.html`, so the final filter:
  ‚Ä¢ Promotes bases and recipes the wiki marks as strong or recommended.  
  ‚Ä¢ Still shows, but visually downplays, those that are not recommended.

// ADDED ‚Äì SHORTER, CLEARER NAMES
- Where names or descriptions are very long, reformat them into:
  ‚Ä¢ A concise main label on one line  
  ‚Ä¢ Optional extra tags on a second line  
- Make rare/jewel/charm names easier to read by standardizing the pattern, e.g.:
  `%COLOR%%NAME% {Life/Res} {T1}` instead of long flavor text.

üß± CRAFTING PRIORITY COLORS
- Tier 1 (best) bases = vibrant highlight  
- Tier 2 = moderate emphasis  
- Tier 3 = minimal glow but still visible
- Include notes for common PD2 crafting recipes and rune upgrades.

üé≤ SHOPPING & GAMBLING
- Add reminders for vendor bases (circlets, claws, wands, scepters).
- Highlight amulets, rings, and circlets that roll well via gambling.

üìú GAMEPLAY TIPS
- Add short inline notes like ‚ÄúCube with Perfect Gem‚Äù, ‚ÄúUse for Runeword‚Äù, or ‚ÄúUpgrade‚Äù.
- Prioritize high-value loot visibility while keeping readability balanced.

üì¶ OUTPUT
Continue output of `Merged_Ultimate.filter`, using ‚â§100k-token chunks.
End each with `[[CONTINUE:n]]`.


FINAL PASS ‚Äî QUALITY & PERFORMANCE OPTIMIZATION

üßπ CLEANUP
- Remove duplicates or conflicting rules created during merging.
- Keep the base filter‚Äôs original order and priority when overlap occurs.

// ADDED ‚Äì DUPLICATE RULE REMOVAL (STRICT)
- Perform a full scan of `Merged_Ultimate.filter` for duplicate or functionally equivalent rules:
  ‚Ä¢ Same or overlapping ItemDisplay conditions? Merge them into one.
  ‚Ä¢ Same alias definitions? Keep a single canonical alias.
- Ensure that no item is covered by two identical rules with different texts or sounds unless this is intentional and documented.

// ADDED ‚Äì VALIDATE AGAINST MERGED_ULTIMATE.FILTER
- Compare the final `Merged_Ultimate.filter` against the previous `MergedUltimatePD2Filter.filter`:
  ‚Ä¢ Confirm that all major sections still exist.  
  ‚Ä¢ Confirm that new sections (craft ALVL, recipes, build-specific, Larzuk, Vengeance, etc.) are present.  
  ‚Ä¢ Confirm that duplicate-removal did NOT accidentally hide or break important rules.

‚öôÔ∏è VALIDATION
Confirm that:
‚úÖ Gold is visible everywhere.  
‚úÖ Gems are visible everywhere (with tiered emphasis).  
‚úÖ Class color themes are applied.  
‚úÖ Crafting bases are clearly marked.  
‚úÖ `{Sell}/{Keep}/{Trade}/{Craft}/{Salvage}` tags appear where appropriate.  
‚úÖ No valuable items or drop types are hidden.
// ADDED:
‚úÖ Crafting recommendations from all filters and from `Crafting - Project Diablo 2.html` are present and correctly labeled as recommended or not recommended to craft.
‚úÖ All long, noisy texts are shortened into readable, compact labels.

üîç PERFORMANCE
- Avoid redundant lines and minimize lag by merging similar rules logically.
- Ensure clear spacing and comments for human readability.

üìã SUMMARY
At the end, print a short ‚ÄúSummary & Checklist‚Äù describing:
- Which filters contributed content
- What categories were added
- What visual and functional upgrades were applied
- Which crafting recommendations came from which source (filters and the crafting HTML guide, if possible).

üì¶ OUTPUT
Emit the remaining code sections of `Merged_Ultimate.filter` until complete, marking the final block as `[[DONE]]`.


COMPLETENESS CHECKLIST ‚Äî DO NOT SKIP
Verify all categories are present and visible:

A) GLOBAL
- Gold always visible (all contexts); stack counts show; pickup sound set
- Gems: all tiers visible and clearly readable
- Runes: display, tooltips, upgrade/cube notes, socket bonuses
- Gems/Jewels/Charms: value cues, rolls, crafting notes
- Sockets: counts on bases, RW eligibility tags

B) CLASSES (Paladin + all others)
- Class color themes applied (Paladin = Holy Light)
- Staffmods/skill trees recognized on class bases
- Top crafting bases per class present and tiered (T1/T2/T3) with `{Craft}` or `{RW}` tags

C) ECONOMY
- `{Sell}/{Keep}/{Trade}/{Craft}/{Salvage}` tags appear where relevant
- Superior ED/DEF rolls and profitable vendor targets noted
- Gambling/vendor callouts (rings/amus/circlets; claws/wands/scepters with staffmods)

// ADDED ‚Äì CRAFTING RECOMMENDATION COVERAGE
- Check that every recipe/base marked as recommended or not recommended to craft in:
  ‚Ä¢ Any `.filter` file in the source folder, and  
  ‚Ä¢ `Crafting - Project Diablo 2.html`  
  is represented in the filter with an appropriate tag or visual treatment.

// ADDED ‚Äì DUPLICATE & NAME CHECK
- Confirm there are no duplicate ItemDisplay or Alias rules.
- Confirm item names and labels are short, consistent, and easy to read.

D) MAPS & BOSSES
- Map immunities/notes; uber mats; keys; cube mats
- Town display of stackable quantities

E) LEGACY/EDGE
- LLD sections; mystery/meme/hyper variants if present
- Shopping sections; weapon range; naming/formatting modules

If ANY item above is missing, append the required rules at the end in a `// MISSING -> ADDED` section and cross-link in the Table of Contents.

FINAL
- Print a short table mapping: {source filter} ‚Üí {sections imported}. End with `[[DONE]]`.
- Where possible, include which sources contributed crafting recommendations (filters and crafting HTML page).
- Also report, for each source `.filter`, whether rules were consumed and commented/removed, to prove that the file was fully processed.
